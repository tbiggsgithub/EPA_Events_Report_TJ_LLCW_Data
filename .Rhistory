plot(x$Rainfall,x$QpkFinal.cms,pch=20,cex=1.4)
mtext(side=2,"Qpk, m3/s",line=3)
text(x=12,y=18,"A. Event total")
plot(x$P6hr,x$QpkFinal.cms,xlab="Rainfall, mm",pch=20,cex=1.4)
mtext(side=2,"  Qpk, m3/s",line=3)
mtext(side=1,"Rainfall, mm",line=3)
text(x=4.5,y=18,"B. 6-hr maximum")
Inew = seq(0,6,by=0.5)
Qpk.CIA.0.4 = 0.278*0.4*Inew*11.0  # 11.0 is drainage are at PT in km2
Qpk.CIA.0.4
lines(Inew*6,Qpk.CIA.0.4)
Qpk.CIA.0.5 = 0.278*0.5*Inew*11.0  # 11.0 is drainage are at PT in km2
lines(Inew*6,Qpk.CIA.0.5,lty=2)
Qpk.CIA.0.8 = 0.278*0.5*Inew*11.0  # 11.0 is drainage are at PT in km2
plot(x$P1hr,x$QpkFinal.cms,pch=20,cex=1.4)
lines(Inew,Qpk.CIA.0.4)
lines(Inew,Qpk.CIA.0.5,lty=2)
lines(Inew,Qpk.CIA.0.8,lty=2)
Qpk.CIA.0.8 = 0.278*0.8*Inew*11.0  # 11.0 is drainage are at PT in km2
lines(Inew,Qpk.CIA.0.8,lty=2)
Qpk.CIA.0.2 = 0.278*0.2*Inew*11.0  # 11.0 is drainage are at PT in km2
Qpk.CIA.0.5 = 0.278*0.5*Inew*11.0  # 11.0 is drainage are at PT in km2
Qpk.CIA.0.8 = 0.278*0.8*Inew*11.0  # 11.0 is drainage are at PT in km2
plot(x$P1hr,x$QpkFinal.cms,pch=20,cex=1.4)
lines(Inew,Qpk.CIA.0.2,lty=2)
lines(Inew,Qpk.CIA.0.5,lty=2)
lines(Inew,Qpk.CIA.0.8,lty=2)
par(mfrow=c(2,1),mar=c(2.5,1,0,1),oma=c(3,4,1,1))
plot(x$Rainfall,x$QpkFinal.cms,pch=20,cex=1.4)
mtext(side=2,"Qpk, m3/s",line=3)
text(x=12,y=18,"A. Event total")
plot(x$P6hr,x$QpkFinal.cms,xlab="Rainfall, mm",pch=20,cex=1.4)
mtext(side=2,"  Qpk, m3/s",line=3)
mtext(side=1,"Rainfall, mm",line=3)
text(x=4.5,y=18,"B. 6-hr maximum")
plot(x$P1hr,x$QpkFinal.cms,pch=20,cex=1.4)
lines(Inew,Qpk.CIA.0.2,lty=2)
lines(Inew,Qpk.CIA.0.5,lty=2)
lines(Inew,Qpk.CIA.0.8,lty=2)
x
median(x)
median(x[,c(3:5)])
median(as.numeric(x[,c(3:5)]))
x[,c(3:5)]
median(x[,c(3:5)])
class(x[,3])
median(x[,3])
median(x[,4])
median(x[,5])
# Calculate precipitation during events for raingages in San Diego, to compare with LLCW data from 2014-2017.
setwd("G:/mydocuments/SDSU/research/tijuana_watershed/writeups/EPA_events_report/EPA_Events_Report_TJ_LLCW_Scripts")
getwd() #the directory where the script is saved
setwd('../EPA_Events_Report_TJ_LLCW_Data') #set working directory as the data folder, which is one folder back in it's own folder
fname = "storm_start_end_dates.csv"
storm.dates = read.csv(fname)
storm.start = as.Date(storm.dates$Start)
storm.end = as.Date(storm.dates$End)
format.precip <- function(indir,fname){
x = read.csv(paste0(indir,fname))
x$Date = as.Date(strptime(x$DATE,format="%Y%m%d"))
x$Date = as.Date(strptime(x$DATE,format="%Y%m%d"))
x$month = as.numeric(format(x$Date,"%m"))
x$year = as.numeric(format(x$Date,"%Y"))
x$wy = x$year
x$wy[x$month>=10] = x$wy[x$month>=10]+1
xout = x[!is.na(x$PRCP.0.1MM),]
return(xout)
}
#  Function to summarize storms for a given raingage
storm.sum <- function(P) {
psum = rep(NA,length(storm.start))
for (i in 1:length(storm.start)){
psum[i]=sum(P[(P$Date<=storm.end[i])&(P$Date>=storm.start[i]),"PRCP.0.1MM"])/10
}
return(psum)
}
# Load P data
# IB.NOF requires custom:
P.IB.NOF = read.csv("climate_daily_IB_Napo.csv")
P.IB.NOF$Date = as.Date(strptime(paste0(P.IB.NOF$Month, "/", P.IB.NOF$Day, "/", P.IB.NOF$Year),format="%m/%d/%Y"))
P.IB.NOF$month = as.numeric(format(P.IB.NOF$Date,"%m"))
P.IB.NOF$year = as.numeric(format(P.IB.NOF$Date, "%Y"))
P.IB.NOF$wy = P.IB.NOF$Year
P.IB.NOF$wy[P.IB.NOF$month>=10] = P.IB.NOF$wy[P.IB.NOF$month>=10]+1
P.IB.NOF$PRCP.0.1MM = P.IB.NOF$Precip*10
P.IB.storms = storm.sum(P.IB.NOF)
indir.Lind = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_lindbergh_field/"
fname.Lind = "125207_lindbergh_field_to_2017.csv"
P.Lind = format.precip(indir.Lind,fname.Lind)
P.Lind.storms = storm.sum(P.Lind)
indir.SDBF = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_san_diego_brown_field/"
fname.SDBF = "san_diego_brown_field_1998_2017.csv"
P.SDBF = format.precip(indir.SDBF,fname.SDBF)
P.SDBF.storms = storm.sum(P.SDBF)
indir.IB33 = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_imperial_beach_33/"
fname.IB33 = "US1CASD0003_IB33_2008_2017.csv"
P.IB33 = format.precip(indir.IB33,fname.IB33)
P.IB33.storms = storm.sum(P.IB33)
storm.sum = data.frame(storm.start,storm.end,P.IB.NOF=P.IB.storms,P.Lind=P.Lind.storms,P.SDBF=P.SDBF.storms,P.IB33=P.IB33.storms,RG.HM=storm.dates$RG.HM.mm)
dev.new()
plot(storm.sum$RG.HM,storm.sum$P.SDBF,pch=20,cex=1.5,xlim=c(0,100),ylim=c(0,100),xlab="Rainfall, Hormiguitas (mm)",ylab="Rainfall other (mm)")
points(storm.sum$RG.HM,storm.sum$P.Lind,pch=20,cex=1.5,col="grey")
points(storm.sum$P.IB33.storms)
points(storm.sum$P.IB33.storms,storm.sum$P.IB33,pch=22,cex=1.5)
storm.sum
points(storm.sum$RG.HM,storm.sum$P.IB33,pch=22,cex=1.5)
abline(0,1,lty=2)
legend("topleft",c("SDBF","Lind","IB3.3"),pch=c(20,20,22),col=c("black","grey","black"))
#dev.new()
plot(storm.sum$RG.HM,storm.sum$P.SDBF,pch=20,cex=1.5,xlim=c(0,100),ylim=c(0,100),xlab="Rainfall, Hormiguitas (mm)",ylab="Rainfall other (mm)")
points(storm.sum$RG.HM,storm.sum$P.Lind,pch=20,cex=1.5,col="grey")
points(storm.sum$RG.HM,storm.sum$P.IB33,pch=22,cex=1.5)
abline(0,1,lty=2)
legend("topleft",c("SDBF","Lind","IB3.3"),pch=c(20,20,22),col=c("black","grey","black"),bty="n")
storm.sum = data.frame(storm.start,storm.end,P.IB.NOF=P.IB.storms,P.Lind=P.Lind.storms,P.SDBF=P.SDBF.storms,P.IB33=P.IB33.storms,RG.HM=storm.dates$RG.HM.mm)
#dev.new()
plot(storm.sum$RG.HM,storm.sum$P.SDBF,pch=20,cex=1.5,xlim=c(0,100),ylim=c(0,100),xlab="Rainfall, Hormiguitas (mm)",ylab="Rainfall other (mm)")
points(storm.sum$RG.HM,storm.sum$P.Lind,pch=20,cex=1.5,col="grey")
points(storm.sum$RG.HM,storm.sum$P.IB33,pch=22,cex=1.5)
abline(0,1,lty=2)
legend("topleft",c("SDBF","Lind","IB3.3"),pch=c(20,20,22),col=c("black","grey","black"),bty="n",pt.cex=c(1.5,1.5,1))
P.all.sub = P.all.sum[P.all.sum$Year %in% seq(2005,2012),]
Pinvent.t = t(P.all.count.1990.2017[,2:(N.stations+1)])  # "3" skips the "COMB" station
Pinvent.t[is.na(Pinvent.t)] = 0
Pinvent.t[Pinvent.t>1]=1
colnames(Pinvent.t) = P.all.count.1990.2017$Year
#  Quality check precipitation data
setwd("G:/mydocuments/SDSU/research/tijuana_watershed/writeups/EPA_events_report/EPA_Events_Report_TJ_LLCW_Scripts")
getwd() #the directory where the script is saved
setwd('../EPA_Events_Report_TJ_LLCW_Data') #set working directory as the data folder, which is one folder back in it's own folder
format.precip <- function(indir,fname){
x = read.csv(paste0(indir,fname))
x$Date = as.Date(strptime(x$DATE,format="%Y%m%d"))
x$Date = as.Date(strptime(x$DATE,format="%Y%m%d"))
x$month = as.numeric(format(x$Date,"%m"))
x$year = as.numeric(format(x$Date,"%Y"))
x$wy = x$year
x$wy[x$month>=10] = x$wy[x$month>=10]+1
xout = x[!is.na(x$PRCP.0.1MM),]
return(xout)
}
summarize.precip <- function(x){
# Calculate total precip
x.ann.P.wy = aggregate(x$PRCP.0.1MM,by=list(x$wy),FUN="sum")
x.ann.count.wy = aggregate(x$PRCP.0.1MM,by=list(x$wy),FUN="length")
xout = data.frame(Year=as.numeric(as.character(x.ann.P.wy$Group.1)),P.mm=x.ann.P.wy$x/10,P.count=x.ann.count.wy$x)
return(xout)
}
P.COMB = read.csv("climate_daily_IB_Napo.csv")
#  Climate_daily_IB_Napo is combination of IB.NOR and Hormiguitas
P.COMB$Date = as.Date(strptime(paste0(P.COMB$Month, "/", P.COMB$Day, "/", P.COMB$Year),format="%m/%d/%Y"))
P.COMB$month = as.numeric(format(P.COMB$Date,"%m"))
P.COMB$year = as.numeric(format(P.COMB$Date, "%Y"))
P.COMB$wy = P.COMB$Year
P.COMB$wy[P.COMB$month>=10] = P.COMB$wy[P.COMB$month>=10]+1
#sum total precip by calendar and wy
# IB, from Napo (Imperial Beach Naval Outlying Field)
COMB.annual.precip.mm.year = aggregate(as.numeric(as.character(P.COMB$Precip)), by= list(as.character(P.COMB$year)), FUN=sum) #sum by water year
COMB.annual.count.by.year = aggregate(as.numeric(as.character(P.COMB$Precip)), by= list(as.character(P.COMB$year)), FUN=length) #sum by water year
COMB.annual.precip.mm.year$P.cm = IB.annual.precip.mm.year$x/10
COMB.annual.precip.mm.wy = aggregate(as.numeric(as.character(P.COMB$Precip)), by= list(as.character(P.COMB$wy)), FUN=sum)
COMB.annual.count.by.wy = aggregate(as.numeric(as.character(P.COMB$Precip)), by= list(as.character(P.COMB$wy)), FUN=length) #sum by water year
P.COMB.sum = data.frame(Year=as.numeric(as.character(COMB.annual.precip.mm.wy$Group.1)),P.mm=COMB.annual.precip.mm.wy$x/10,P.count=COMB.annual.count.by.wy$x)
# read in Lindbergh Field
indir.Lind = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_lindbergh_field/"
fname.Lind = "125207_lindbergh_field_to_2017.csv"
P.Lind = format.precip(indir.Lind,fname.Lind)
P.Lind.sum = summarize.precip(x=P.Lind)
#  Summarize IB, Ream Field
indir.IB.ream = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_imperial_beach_ream_field_NAS/"
fname.IB.ream = "imperial_beach_ream_field_daily_1945_2012.csv"
P.IBream = format.precip(indir.IB.ream,fname.IB.ream)
P.IBream.sum = summarize.precip(x=P.IBream)
#  Summarize Chula Vista
indir.Chula.Vista = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_chula_vista/"
fname.Chula.Vista = "chula_vista_1918_2012.csv"
P.Chula.Vista = format.precip(indir.Chula.Vista,fname.Chula.Vista)
P.Chula.Vista.sum = summarize.precip(x=P.Chula.Vista)
#  Summarize Jamul
indir.Jamul = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_jamul/"
fname.Jamul = "san_diego_jamul_daily_precip_1998_2012.csv"
P.Jamul = format.precip(indir.Jamul,fname.Jamul)
P.Jamul.sum = summarize.precip(x=P.Jamul)
#  Summarize IB33
indir.IB33 = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_imperial_beach_33/"
fname.IB33 = "US1CASD0003_IB33_2008_2017.csv"
P.IB33 = format.precip(indir.IB33,fname.IB33)
P.IB33.sum = summarize.precip(x=P.IB33)
#  Summarize SD Brownfield
indir.SDBF = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_san_diego_brown_field/"
fname.SDBF = "san_diego_brown_field_1998_2017.csv"
P.SDBF = format.precip(indir.SDBF,fname.SDBF)
P.SDBF.sum = summarize.precip(x=P.SDBF)
# Compile into output data frame, table
yrange = range(range(P.COMB.sum$Year),range(P.IB33.sum$Year),range(P.Jamul.sum$Year),range(P.Chula.Vista.sum$Year),range(P.Lind.sum$Year))
P.all.count = data.frame(Year=seq(yrange[1],yrange[2]))
st.list = c("COMB","Lind","IBream","Jamul","IB33","Chula.Vista","SDBF")
st.list = c("Lind","IBream","Jamul","IB33","Chula.Vista","SDBF")
N.stations = length(st.list)
for (i in 1:N.stations){
eval(parse(text=paste0("df.tmp  = P.", st.list[i],".sum")))
match.tmp = match(df.tmp$Year,P.all.count$Year)
P.all.count[match.tmp,i+1] = df.tmp$P.count/365
}
names(P.all.count) = c("Year",st.list)
P.all.count.1990.2017 = P.all.count[P.all.count$Year %in% seq(2005,2016),]
P.all.sum = data.frame(Year=seq(yrange[1],yrange[2]))
for (i in 1:N.stations){
eval(parse(text=paste0("df.tmp  = P.", st.list[i],".sum")))
match.tmp = match(df.tmp$Year,P.all.sum$Year)
P.all.sum[match.tmp,i+1] = df.tmp$P.mm
}
names(P.all.sum) = c("Year",st.list)
P.all.sub = P.all.sum[P.all.sum$Year %in% seq(2005,2012),]
Pinvent.t = t(P.all.count.1990.2017[,2:(N.stations+1)])  # "3" skips the "COMB" station
Pinvent.t[is.na(Pinvent.t)] = 0
Pinvent.t[Pinvent.t>1]=1
colnames(Pinvent.t) = P.all.count.1990.2017$Year
grid = expand.grid(X=as.numeric(colnames(Pinvent.t)),Y=seq(1:N.stations))
grid$Z = as.vector(t(Pinvent.t))
library(latticeExtra)
col.l <- colorRampPalette(c('red', 'orange', 'yellow', 'green', 'cyan', 'blue'))
levelplot(Z ~ X*Y, data = grid, xlab="",ylab="",scales=list(y=list(at=seq(1:N.stations),
labels=st.list),x=list(at=colnames(Pinvent.t),labels=colnames(Pinvent.t),rot=90)),
#colorkey=list(at=seq(0, 1, 0.2),
#labels=list(at=c(0, 0.3, 0.6, 0.9),
#            labels=c("none", "a bit", "a bit more", "a lot"))),
col.regions=col.l) +
layer(panel.text(X, Y, round(Z, 2),cex=0.7), data = grid)
dev.new()
P.all.sub = P.all.sum[P.all.sum$Year %in% seq(1980,2012),]
Pinvent.t = t(P.all.count.1990.2017[,2:(N.stations+1)])  # "3" skips the "COMB" station
Pinvent.t[is.na(Pinvent.t)] = 0
Pinvent.t[Pinvent.t>1]=1
colnames(Pinvent.t) = P.all.count.1990.2017$Year
grid = expand.grid(X=as.numeric(colnames(Pinvent.t)),Y=seq(1:N.stations))
grid$Z = as.vector(t(Pinvent.t))
library(latticeExtra)
col.l <- colorRampPalette(c('red', 'orange', 'yellow', 'green', 'cyan', 'blue'))
levelplot(Z ~ X*Y, data = grid, xlab="",ylab="",scales=list(y=list(at=seq(1:N.stations),
labels=st.list),x=list(at=colnames(Pinvent.t),labels=colnames(Pinvent.t),rot=90)),
#colorkey=list(at=seq(0, 1, 0.2),
#labels=list(at=c(0, 0.3, 0.6, 0.9),
#            labels=c("none", "a bit", "a bit more", "a lot"))),
col.regions=col.l) +
layer(panel.text(X, Y, round(Z, 2),cex=0.7), data = grid)
P.all.count.1990.2017 = P.all.count[P.all.count$Year %in% seq(1980,2016),]
P.all.sum = data.frame(Year=seq(yrange[1],yrange[2]))
for (i in 1:N.stations){
eval(parse(text=paste0("df.tmp  = P.", st.list[i],".sum")))
match.tmp = match(df.tmp$Year,P.all.sum$Year)
P.all.sum[match.tmp,i+1] = df.tmp$P.mm
}
names(P.all.sum) = c("Year",st.list)
P.all.sub = P.all.sum[P.all.sum$Year %in% seq(1980,2012),]
Pinvent.t = t(P.all.count.1990.2017[,2:(N.stations+1)])  # "3" skips the "COMB" station
Pinvent.t[is.na(Pinvent.t)] = 0
Pinvent.t[Pinvent.t>1]=1
colnames(Pinvent.t) = P.all.count.1990.2017$Year
grid = expand.grid(X=as.numeric(colnames(Pinvent.t)),Y=seq(1:N.stations))
grid$Z = as.vector(t(Pinvent.t))
library(latticeExtra)
col.l <- colorRampPalette(c('red', 'orange', 'yellow', 'green', 'cyan', 'blue'))
levelplot(Z ~ X*Y, data = grid, xlab="",ylab="",scales=list(y=list(at=seq(1:N.stations),
labels=st.list),x=list(at=colnames(Pinvent.t),labels=colnames(Pinvent.t),rot=90)),
#colorkey=list(at=seq(0, 1, 0.2),
#labels=list(at=c(0, 0.3, 0.6, 0.9),
#            labels=c("none", "a bit", "a bit more", "a lot"))),
col.regions=col.l) +
layer(panel.text(X, Y, round(Z, 2),cex=0.7), data = grid)
P.all.count.1990.2017 = P.all.count[P.all.count$Year %in% seq(2005,2016),]
P.all.sum = data.frame(Year=seq(yrange[1],yrange[2]))
for (i in 1:N.stations){
eval(parse(text=paste0("df.tmp  = P.", st.list[i],".sum")))
match.tmp = match(df.tmp$Year,P.all.sum$Year)
P.all.sum[match.tmp,i+1] = df.tmp$P.mm
}
names(P.all.sum) = c("Year",st.list)
P.all.sub = P.all.sum[P.all.sum$Year %in% seq(1980,2012),]
Pinvent.t = t(P.all.count.1990.2017[,2:(N.stations+1)])  # "3" skips the "COMB" station
Pinvent.t[is.na(Pinvent.t)] = 0
Pinvent.t[Pinvent.t>1]=1
colnames(Pinvent.t) = P.all.count.1990.2017$Year
grid = expand.grid(X=as.numeric(colnames(Pinvent.t)),Y=seq(1:N.stations))
grid$Z = as.vector(t(Pinvent.t))
library(latticeExtra)
col.l <- colorRampPalette(c('red', 'orange', 'yellow', 'green', 'cyan', 'blue'))
levelplot(Z ~ X*Y, data = grid, xlab="",ylab="",scales=list(y=list(at=seq(1:N.stations),
labels=st.list),x=list(at=colnames(Pinvent.t),labels=colnames(Pinvent.t),rot=90)),
#colorkey=list(at=seq(0, 1, 0.2),
#labels=list(at=c(0, 0.3, 0.6, 0.9),
#            labels=c("none", "a bit", "a bit more", "a lot"))),
col.regions=col.l) +
layer(panel.text(X, Y, round(Z, 2),cex=0.7), data = grid)
setwd("G:/mydocuments/SDSU/research/tijuana_watershed/writeups/EPA_events_report/EPA_Events_Report_TJ_LLCW_Scripts")
getwd() #the directory where the script is saved
setwd('../EPA_Events_Report_TJ_LLCW_Data') #set working directory as the data folder, which is one folder back in it's own folder
table.trap.efficiency = read.csv("sediment_loads_2006_2012_corrected_uncorrected_05182017.csv") #table with date and total excavation from TJE traps
tje.corr.2006.2012.totals = table.trap.efficiency[as.character(table.trap.efficiency$Sed_size) == "Total",] #only use annual totals
P.IB = read.csv("climate_daily_IB_Napo.csv")
P.IB$Date = as.Date(strptime(paste0(precip$Month, "/", precip$Day, "/", precip$Year),format="%m/%d/%Y"))
P.IB$month = as.numeric(format(P.IB$Date,"%m"))
P.IB = read.csv("climate_daily_IB_Napo.csv")
P.IB$Date = as.Date(strptime(paste0(P.IB$Month, "/", P.IB$Day, "/", P.IB$Year),format="%m/%d/%Y"))
P.IB$month = as.numeric(format(P.IB$Date,"%m"))
P.IB$year = as.numeric(format(P.IB$Date, "%Y"))
P.IB$wy = P.IB$Year
P.IB$wy[P.IB$month>=10] = P.IB$wy[P.IB$month>=10]+1
format.precip <- function(indir,fname){
x = read.csv(paste0(indir,fname))
x$Date = as.Date(strptime(x$DATE,format="%Y%m%d"))
x$Date = as.Date(strptime(x$DATE,format="%Y%m%d"))
x$month = as.numeric(format(x$Date,"%m"))
x$year = as.numeric(format(x$Date,"%Y"))
x$wy = x$year
x$wy[x$month>=10] = x$wy[x$month>=10]+1
xout = x[!is.na(x$PRCP.0.1MM),]
return(xout)
}
summarize.precip <- function(x){
# Calculate total precip
x.ann.P.wy = aggregate(x$PRCP.0.1MM,by=list(x$wy),FUN="sum")
x.ann.count.wy = aggregate(x$PRCP.0.1MM,by=list(x$wy),FUN="length")
xout = data.frame(Year=as.numeric(as.character(x.ann.P.wy$Group.1)),P.mm=x.ann.P.wy$x/10,P.count=x.ann.count.wy$x)
return(xout)
}
indir.Lind = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_lindbergh_field/"
fname.Lind = "125207_lindbergh_field.csv"
P.lind = format.precip(indir.Lind,fname.Lind)
P.lind.sum = summarize.precip(x=P.lind)
indir.SDBF = "G:/mydocuments/SDSU/research/tijuana_watershed/precipitation/NOAA_san_diego_brown_field/"
fname.SDBF = "san_diego_brown_field_1998_2017.csv"
P.SDBF = format.precip(indir.SDBF,fname.SDBF)
P.SDBF.sum = summarize.precip(x=P.SDBF)
cut.dates = as.Date(tje.corr.2006.2012.totals$Removal.date)
P.IB$cut.labels = cut(P.IB$Date, cut.dates, labels=tje.corr.2006.2012.totals$Removal_WY_Date[2:length(tje.corr.2006.2012.totals$Removal_WY_Date)])
P.IB.by.cut.date = aggregate(P.IB$Precip,by=list(P.IB$cut.labels),FUN="sum")
tje.corr.2006.2012.totals$P.by.cut.date.mm = c(NA,P.IB.by.cut.date$x)
P.lind$cut.labels = cut(P.lind$Date, cut.dates, labels=tje.corr.2006.2012.totals$Removal_WY_Date[2:length(tje.corr.2006.2012.totals$Removal_WY_Date)])
P.lind.by.cut.date = aggregate(P.lind$PRCP.0.1MM,by=list(P.lind$cut.labels),FUN="sum")
tje.corr.2006.2012.totals$P.lind.by.cut.date.mm = c(NA,P.lind.by.cut.date$x/10)
P.SDBF$cut.labels = cut(P.SDBF$Date, cut.dates, labels=tje.corr.2006.2012.totals$Removal_WY_Date[2:length(tje.corr.2006.2012.totals$Removal_WY_Date)])
P.SDBF.by.cut.date = aggregate(P.SDBF$PRCP.0.1MM,by=list(P.SDBF$cut.labels),FUN="sum")
tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm = c(NA,P.SDBF.by.cut.date$x/10)
dev.new()
par(mfrow=c(3,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
tje.no2005 = tje.corr.2006.2012.totals[tje.corr.2006.2012.totals$Removal_WY_Date>=2006,]
dev.new()
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
plot(tje.no2005$P.by.cut.date.mm,tje.no2005$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000))
points(tje.no2005$P.by.cut.date.mm,tje.no2005$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load, tons",line=3)
plot(tje.no2005$P.lind.by.cut.date.mm,tje.no2005$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000))
points(tje.no2005$P.lind.by.cut.date.mm,tje.no2005$Corrected_load_tons,col="grey",pch=20,cex=1.5)
mtext(side=2,"Sediment load, tons",line=3)
mtext(side=1,"Precipitation, Lindbergh, mm",line=3)
par(mfrow=c(2,1),mar=c(1,0,0,0),oma=c(4,5,2,2))
plot(P.IB$Date,P.IB$Precip,type="l",xlim=as.Date(c("2004-10-10","2016-12-31")))
abline(v=cut.dates,lty=2,lwd=2,col="grey")
mtext(side=2,"Daily Precipitation, mm",line=3)
plot(P.lind$Date,P.lind$PRCP/10,type="l",xlim=as.Date(c("2004-10-10","2016-12-31")))
abline(v=cut.dates,lty=2,lwd=2,col="grey")
par(mfrow=c(1,1))
plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,xlab="P, mm, IB",ylab="P, mm, Lind")
abline(0,1)
dev.new()
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
?text
dev.new()
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
#plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
#points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons")
text(x=50,y=70000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons")
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=2,"Precipitation between cleanings, mm")
text(x=50,y=70000,"B. SDBF")
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
text(x=50,y=70000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=2,"Precipitation between cleanings, mm",line=3)
text(x=50,y=70000,"B. SDBF")
dev.new()
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
#plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
#points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
text(x=50,y=80000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=2,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000,"B. SDBF")
dev.new()
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
#plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
#points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
text(x=50,y=80000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=2,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000,"B. SDBF")
dev.new()
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
#plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
#points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
text(x=50,y=80000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=1,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000,"B. SDBF")
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
text(x=50,y=80000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=1,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000,"B. SDBF")
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
#plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
#points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#mtext(side=2,"Sediment load to traps, tons",line=3)
text(x=50,y=80000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"           Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=1,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000,"B. SDBF")
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#mtext(side=2,"Sediment load to traps, tons",line=3)
text(x=50,y=80000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
mtext(side=2,"                                                Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=1,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000,"B. SDBF")
par(mfrow=c(2,1),mar=c(2,0,0,0),oma=c(4,5,2,2))
#plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
#points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected/1000,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000/1000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons/1000,pch=20,cex=1.5,col="grey")
#mtext(side=2,"Sediment load to traps, thousand tons",line=3)
text(x=50,y=80000/1000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected/1000,pch=20,cex=1.5,ylim=c(0,90000/1000),xlim=c(0,600))
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons/1000,pch=20,cex=1.5,col="grey")
mtext(side=2,"                                                Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=1,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000/1000,"B. SDBF")
#plot(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000),xlim=c(0,600))
#points(tje.corr.2006.2012.totals$P.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons,pch=20,cex=1.5,col="grey")
#text()
plot(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected/1000,xlab="Precipitation between cleanings, mm",ylab="Tons removed",pch=20,cex=1.5,ylim=c(0,90000/1000),xlim=c(0,600),las=1)
points(tje.corr.2006.2012.totals$P.lind.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons/1000,pch=20,cex=1.5,col="grey")
#mtext(side=2,"Sediment load to traps, thousand tons",line=3)
text(x=50,y=80000/1000,"A. Lind")
plot(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Tons_removed_uncorrected/1000,pch=20,cex=1.5,ylim=c(0,90000/1000),xlim=c(0,600),las=1)
points(tje.corr.2006.2012.totals$P.SDBF.by.cut.date.mm,tje.corr.2006.2012.totals$Corrected_load_tons/1000,pch=20,cex=1.5,col="grey")
mtext(side=2,"                                                Sediment load to traps, tons",line=3)
legend("bottomright",c("Uncorrected","Corrected"),pch=20,pt.cex=1.5,col=c("black","grey"),bty="n")
mtext(side=1,"Precipitation between cleanings, mm",line=3)
text(x=50,y=80000/1000,"B. SDBF")
